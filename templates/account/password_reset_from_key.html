{% extends 'base.html' %}
{% load static %}

{% block title %}ƒê·∫∑t m·∫≠t kh·∫©u m·ªõi - VN Travel{% endblock %}

{% block content %}
<!-- Threeland Hero - Change Password -->
<div class="threeland-hero" style="min-height: 100vh; padding: 120px 0 80px 0;">
  <div class="hero-background-image" style="background-image: url('https://images.unsplash.com/photo-1614064641938-3bbee52942c7?w=1920&q=80');"></div>
  <div class="hero-overlay" style="z-index: 1;"></div>
  
  <div class="hero-main-content" style="position: static; transform: none; top: auto; left: auto; padding: 0; z-index: 10;">
    <div class="container" style="position: relative; z-index: 10;">
      <div class="row justify-content-center">
        <div class="col-lg-5 col-md-7 col-sm-10">
          <!-- Change Password Card -->
          <div class="card shadow-lg rounded-premium border-0" style="background: rgba(255,255,255,0.98); backdrop-filter: blur(10px); position: relative; z-index: 100;">
            <div class="card-body p-4 p-md-5">
              <!-- Icon -->
              <div class="text-center mb-3">
                <div style="width: 70px; height: 70px; margin: 0 auto; background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);">
                  <i class="ni ni-lock-circle-open" style="font-size: 32px; color: white;"></i>
                </div>
              </div>

              <!-- Title -->
              <h2 class="text-center" style="font-family: 'Playfair Display', serif; font-weight: 700; color: #1e293b; margin-bottom: 0.75rem; font-size: 1.75rem;">
                ƒê·∫∑t m·∫≠t kh·∫©u m·ªõi üîê
              </h2>

              <p class="text-center" style="color: #64748b; font-size: 15px; margin-bottom: 1.5rem;">
                Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u m·ªõi cho t√†i kho·∫£n c·ªßa b·∫°n
              </p>

              <!-- Form -->
              <form method="post">
                {% csrf_token %}
                
                {% if form.errors %}
                  <div class="alert alert-danger" style="border-radius: var(--radius-lg); border: none; margin-bottom: 1rem;">
                    <strong>L·ªói:</strong> Vui l√≤ng ki·ªÉm tra l·∫°i th√¥ng tin b√™n d∆∞·ªõi.
                  </div>
                {% endif %}

                <!-- New Password -->
                <div class="mb-3">
                  <label for="{{ form.password1.id_for_label }}" class="form-label" style="font-weight: 600; color: #475569; font-size: 14px;">
                    <i class="ni ni-lock-circle-open me-2"></i>M·∫≠t kh·∫©u m·ªõi
                  </label>
                  <div style="position: relative;">
                    <input 
                      type="password" 
                      name="password1" 
                      id="{{ form.password1.id_for_label }}"
                      class="form-control form-control-lg password-input" 
                      placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi"
                      required
                      style="border-radius: var(--radius-lg); border: 1px solid #cbd5e1; padding: 0.75rem 3rem 0.75rem 1rem;"
                    >
                    <button type="button" class="toggle-password" data-target="{{ form.password1.id_for_label }}" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); border: none; background: none; cursor: pointer; color: #1e293b; padding: 0; width: 35px; height: 35px; display: flex; align-items: center; justify-content: center; font-size: 22px;">
                      üôà
                    </button>
                  </div>
                  {% if form.password1.errors %}
                    <div class="text-danger small mt-1">{{ form.password1.errors }}</div>
                  {% endif %}
                </div>

                <!-- Confirm Password -->
                <div class="mb-3">
                  <label for="{{ form.password2.id_for_label }}" class="form-label" style="font-weight: 600; color: #475569; font-size: 14px;">
                    <i class="ni ni-lock-circle-open me-2"></i>X√°c nh·∫≠n m·∫≠t kh·∫©u
                  </label>
                  <div style="position: relative;">
                    <input 
                      type="password" 
                      name="password2" 
                      id="{{ form.password2.id_for_label }}"
                      class="form-control form-control-lg password-input" 
                      placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u"
                      required
                      style="border-radius: var(--radius-lg); border: 1px solid #cbd5e1; padding: 0.75rem 3rem 0.75rem 1rem;"
                    >
                    <button type="button" class="toggle-password" data-target="{{ form.password2.id_for_label }}" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); border: none; background: none; cursor: pointer; color: #1e293b; padding: 0; width: 35px; height: 35px; display: flex; align-items: center; justify-content: center; font-size: 22px;">
                      üôà
                    </button>
                  </div>
                  {% if form.password2.errors %}
                    <div class="text-danger small mt-1">
                      {% for error in form.password2.errors %}
                        {% if 'same password' in error|lower %}
                          B·∫°n ph·∫£i nh·∫≠p c√πng m·ªôt m·∫≠t kh·∫©u m·ªói l·∫ßn.
                        {% else %}
                          {{ error }}
                        {% endif %}
                      {% endfor %}
                    </div>
                  {% endif %}
                </div>

                <!-- Password Requirements -->
                <div class="alert alert-info mb-3" style="border-radius: var(--radius-lg); border: none; background: #e0f2fe; padding: 0.75rem;">
                  <small style="color: #0369a1;">
                    <strong>Y√™u c·∫ßu m·∫≠t kh·∫©u:</strong>
                    <ul class="mb-0" style="padding-left: 1.25rem; margin-top: 0.5rem;">
                      <li>T·ªëi thi·ªÉu 8 k√Ω t·ª±</li>
                      <li>Kh√¥ng qu√° gi·ªëng th√¥ng tin c√° nh√¢n</li>
                      <li>Kh√¥ng ph·∫£i m·∫≠t kh·∫©u ph·ªï bi·∫øn</li>
                      <li>Kh√¥ng ho√†n to√†n l√† s·ªë</li>
                    </ul>
                  </small>
                </div>

                <!-- Submit Button -->
                <div class="d-grid gap-2 mb-3">
                  <button type="submit" class="btn btn-primary btn-lg" style="border-radius: var(--radius-lg); background: var(--gradient-hero); border: none; font-weight: 600; font-size: 15px;">
                    <i class="ni ni-check-bold me-2"></i>
                    ƒê·ªïi m·∫≠t kh·∫©u
                  </button>
                  
                  <a href="{% url 'account_login' %}" class="btn btn-outline-secondary" style="border-radius: var(--radius-lg); font-weight: 600; font-size: 14px;">
                    <i class="ni ni-bold-left me-2"></i>
                    Quay l·∫°i ƒëƒÉng nh·∫≠p
                  </a>
                </div>
              </form>

              <!-- Security Note -->
              <div class="text-center mt-3" style="color: #64748b; font-size: 13px;">
                <i class="ni ni-lock-circle-open me-1"></i>
                M·∫≠t kh·∫©u c·ªßa b·∫°n ƒë∆∞·ª£c m√£ h√≥a an to√†n
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .form-control:focus {
    border-color: var(--primary-light);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }

  .card {
    animation: zoomIn 0.4s ease-out;
  }

  @keyframes zoomIn {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  .toggle-password:hover {
    color: var(--primary-light);
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Password toggle functionality
    const toggleButtons = document.querySelectorAll('.toggle-password');
    
    toggleButtons.forEach(button => {
      button.addEventListener('click', function() {
        const targetId = this.getAttribute('data-target');
        const input = document.getElementById(targetId);
        
        if (input.type === 'password') {
          input.type = 'text';
          this.innerHTML = 'üëÅÔ∏è'; // Show open eye when visible
        } else {
          input.type = 'password';
          this.innerHTML = 'üôà'; // Show covered eye when hidden
        }
      });
    });
  });
</script>
{% endblock %}
