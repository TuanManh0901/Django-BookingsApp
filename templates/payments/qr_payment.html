{% extends 'base.html' %}
{% load humanize %}
{% load formatting %}
{% block title %}Thanh to√°n QR Code{% endblock %}

{% block content %}
<!-- Threeland Hero - QR Payment -->
<div class="threeland-hero hero-short">
  <div class="hero-background-image" style="background-image: url('https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=1920&q=80');"></div>
  <div class="hero-overlay"></div>
  
  <div class="hero-main-content">
    <p class="hero-subtitle">PAYMENT</p>
    <h1 class="hero-main-title">Thanh to√°n QR Code</h1>
  </div>
</div>

<div class="container mt-4">

    {% if messages %} <div class="messages">
        {% for message in messages %} <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }} <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}
 <div class="row"> <div class="col-md-8"> <div class="card"> <div class="card-header">
                    <h5>üìã Th√¥ng tin thanh to√°n</h5>
                </div> <div class="card-body text-center"> <div class="mb-4"> <img src="https://api.vietqr.io/image/970436-123456789012-qr_only.png?amount={{ payment.amount }}&addInfo=Booking%20{{ booking.id }}" alt="QR Code" class="img-fluid" style="max-width: 300px;">
                    </div>
 <div class="info-box" style="background-color: #d1ecf1; border: 1px solid #bee5eb; padding: 1rem; border-radius: 0.5rem; color: #1e293b !important;">
                        <h6>H∆∞·ªõng d·∫´n thanh to√°n:</h6> <ol class="text-start">
                            <li>M·ªü ·ª©ng d·ª•ng ng√¢n h√†ng c·ªßa b·∫°n</li>
                            <li>Qu√©t m√£ QR ·ªü tr√™n</li>
                            <li>Nh·∫≠p s·ªë ti·ªÅn: <strong>{{ payment.amount|vn_intcomma }} VNƒê</strong></li>
                            <li>Th√™m ghi ch√∫: <strong>Booking {{ booking.id }}</strong></li>
                            <li>Ho√†n t·∫•t thanh to√°n</li>
                            <li>Upload h√¨nh ·∫£nh bi√™n lai b√™n d∆∞·ªõi</li>
                        </ol>
                    </div>
 <div class="mt-4">
                        <h5>üì§ Upload bi√™n lai</h5> <form action="{% url 'payments:upload_qr_receipt' payment.id %}" method="post" enctype="multipart/form-data">
                            {% csrf_token %} <div class="mb-3"> <input type="file" class="form-control" name="receipt_image" accept="image/*" required> <div class="form-text">Ch·ªçn file h√¨nh ·∫£nh c·ªßa bi√™n lai thanh to√°n</div>
                            </div> <button type="submit" class="btn btn-success btn-lg"> <i class="fas fa-upload"></i> Upload bi√™n lai
                            </button>
                        </form>
                    </div>
 <div class="mt-3"> <a href="{% url 'payments:select_payment_method' booking.id %}" class="btn btn-secondary"> <i class="fas fa-arrow-left"></i> Quay l·∫°i ch·ªçn ph∆∞∆°ng th·ª©c
                        </a>
                    </div>
                </div>
            </div>
        </div>
 <div class="col-md-4">
            <!-- T√≥m t·∫Øt ƒë∆°n h√†ng --> <div class="card"> <div class="card-header">
                    <h5>üìã T√≥m t·∫Øt ƒë∆°n h√†ng</h5>
                </div> <div class="card-body"> <div class="d-flex justify-content-between mb-2">
                        <span>Tour:</span>
                        <span>{{ booking.tour.name }}</span>
                    </div> <div class="d-flex justify-content-between mb-2">
                        <span>Ng∆∞·ªùi l·ªõn:</span>
                        <span>{{ booking.num_adults }}</span>
                    </div> <div class="d-flex justify-content-between mb-2">
                        <span>Tr·∫ª em:</span>
                        <span>{{ booking.num_children }}</span>
                    </div>
                    <hr> <div class="d-flex justify-content-between">
                        <strong>S·ªë ti·ªÅn c·∫ßn thanh to√°n:</strong>
                        <strong>{{ payment.amount|vn_intcomma }} VNƒê</strong>
                    </div>
                </div>
            </div>

            <!-- Th√¥ng tin chuy·ªÉn kho·∫£n --> <div class="card mt-3"> <div class="card-header">
                    <h6>üè¶ Th√¥ng tin chuy·ªÉn kho·∫£n</h6>
                </div> <div class="card-body"> <p class="small"><strong>Ng√¢n h√†ng:</strong> Vietcombank</p> <p class="small"><strong>S·ªë t√†i kho·∫£n:</strong> 123456789012</p> <p class="small"><strong>Ch·ªß t√†i kho·∫£n:</strong> VN-TRAVEL</p> <p class="small"><strong>N·ªôi dung:</strong> Booking {{ booking.id }}</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}